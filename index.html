<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Birthday Surprise</title>
  <style>
    html, body {
      margin:0; padding:0; width:100%; height:100%;
      background:#ffe6f2; overflow:hidden;
    }
    canvas {
      position:absolute; top:0; left:0;
      width:100%; height:100%; z-index:1;
    }
    #container {
      position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      z-index:2;
      display:flex; flex-direction:column;
      align-items:center; text-align:center;
      max-width:90vw; word-break:break-word;
      font-family:'Comic Sans MS', cursive, sans-serif;
    }
    #happy, #rest {
      font-size:clamp(24px,6vw,48px);
      opacity:0;
      transition:opacity .8s ease, transform .8s ease;
      color:#6b2e4a;
      text-shadow:0 0 5px #b76e79,0 0 10px #b76e79;
    }
    #countdown {
      font-size:clamp(50px,15vw,100px);
      margin:8px 0;
      color:#6b2e4a;
      text-shadow:0 0 5px #b76e79,0 0 10px #b76e79;
    }
    #polaroid-container {
      opacity:0; margin-top:20px;
      background:#fff; padding:6px;
      box-shadow:0 4px 12px rgba(0,0,0,0.3);
      transform:rotate(-8deg) scale(.8);
      transition:opacity 1s ease, transform .8s ease;
      max-width:50vw;
    }
    #polaroid {
      width:100%; height:auto; border-radius:4px;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="container">
    <span id="happy">Happy</span>
    <span id="countdown">1</span>
    <span id="rest">Birthday Preethiiii Maaa</span>
    <div id="polaroid-container">
      <img id="polaroid" src="polaroid.jpeg" alt="Polaroid">
    </div>
  </div>
  <script>
    window.onload = () => {
      // Elements
      const cvs = document.getElementById('canvas'),
            ctx = cvs.getContext('2d'),
            happy = document.getElementById('happy'),
            countEl = document.getElementById('countdown'),
            rest = document.getElementById('rest'),
            poly = document.getElementById('polaroid-container');

      // Canvas sizing
      let cw, ch, dpr;
      let particles = [], t = 0;
      let revolt = false; // swirl mode

      function resize() {
        dpr = window.devicePixelRatio || 1;
        cvs.width  = window.innerWidth * dpr;
        cvs.height = window.innerHeight * dpr;
        ctx.setTransform(1,0,0,1,0,0);
        ctx.scale(dpr, dpr);
        cw = window.innerWidth;
        ch = window.innerHeight;
        particles = [];
      }
      resize();
      window.addEventListener('resize', resize);

      ctx.globalCompositeOperation = 'lighter';

      // Particle class
      class P {
        constructor(x,y,vx,vy,rev=false) {
          this.x = x; this.y = y;
          this.vx = vx; this.vy = vy;
          this.rev = rev;
          this.size = rev ? 8 : 5;
          this.alpha = 1;
          this.decay = rev ? 0.00005 : 0.0001; 
          this.off = Math.random()*Math.PI*2;
        }
        update(i) {
          if(this.rev) {
            // Infinity parameters relative to canvas
            const a = Math.max(Math.min(cw/4,200),120),
                  b = Math.max(Math.min(ch/8,100),60),
                  lt = t + this.off;
            this.x = cw/2 + a * Math.sin(lt);
            this.y = ch/2 + b * Math.sin(2*lt);
          } else {
            this.x += this.vx; this.y += this.vy;
          }
          this.alpha -= this.decay;
          if(this.alpha <= 0) particles.splice(i,1);
        }
        draw() {
          ctx.beginPath();
          ctx.arc(this.x,this.y,this.size,0,2*Math.PI);
          ctx.fillStyle = `hsla(45,100%,60%,${this.alpha})`;
          ctx.shadowBlur = 40; ctx.shadowColor = 'gold';
          ctx.fill();
        }
      }

      function spawnRandom() {
        for(let i=0;i<4;i++){
          const ang = Math.random()*2*Math.PI,
                spd = Math.random()*0.2+0.05;
          particles.push(new P(
            Math.random()*cw, Math.random()*ch,
            Math.cos(ang)*spd, Math.sin(ang)*spd
          ));
        }
      }

      function spawnSwirl() {
        // spawn multiple swirling particles per frame
        for(let i=0;i<4;i++) particles.push(new P(0,0,0,0,true));
      }

      // Countdown logic
      let num = 1;
      countEl.textContent = num;
      const iv = setInterval(()=>{
        num++;
        if(num<=22){
          countEl.style.opacity = 0;
          setTimeout(()=>{
            countEl.textContent = num;
            countEl.style.opacity = 1;
          }, 200);
        }
        if(num===22){
          clearInterval(iv);
          setTimeout(()=>{
            countEl.textContent = '22nd';
            happy.style.opacity = 1;
            happy.style.transform = 'translateY(-5px)';
            rest.style.opacity = 1;
            rest.style.transform = 'translateY(5px)';
            poly.style.opacity = 1;
            poly.style.transform = 'rotate(-2deg) scale(1)';
            revolt = true;
          }, 500);
        }
      },1000);

      // Animation loop
      (function loop(){
        requestAnimationFrame(loop);
        // gentle fade
        ctx.fillStyle = 'rgba(255,230,242,0.02)';
        ctx.fillRect(0,0,cw,ch);

        if(revolt){
          t += 0.01;           // speed up swirl
          spawnSwirl();        // dense swirling
        } else {
          spawnRandom();       // random sparkles
        }

        particles.forEach((p,i)=>{ p.update(i); p.draw(); });
      })();
    };
  </script>
</body>
</html>
